#LyX file created by tex2lyx 2.2
\lyxformat 508
\begin_document
\begin_header
\save_transient_properties true
\origin /home/lg/agrosavia/GWAS/MultiGWAS-dev/development/paper-ecology/overleaf/ago14/
\textclass article
\begin_preamble
\usepackage{listings}% To show when calling multiGWAS from console
\usepackage{hyphenat}
% For writhing p-values
\newcommand{\mathA}[1]{{\operatorname{#1}}}
\newcommand{\mathB}[1]{{\operatorname{\mathit{#1}}}}
\renewcommand{\textrightarrow}{$\rightarrow$}
% Small fonts in figure captions
\usepackage[font=scriptsize,labelfont=bf]{caption}
\hyphenation{GWAS-poly tetra-ploid}
%---------------------------------------------------
\usepackage{authblk}


%----For References ---------------
% PAULA
\usepackage[backend=biber,style=apa,]{biblatex}
\addbibresource{multiGWAS.bib}
%---------------------------------------------


\end_preamble
\use_default_options false
\maintain_unincluded_children false
\language english
\language_package none
\inputencoding utf8
\fontencoding T1
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_bookmarks 0
\pdf_bookmarksnumbered 0
\pdf_bookmarksopen 0
\pdf_bookmarksopenlevel 1
\pdf_breaklinks 0
\pdf_pdfborder 0
\pdf_colorlinks 0
\pdf_backref section
\pdf_pdfusetitle 0
\papersize default
\use_geometry false
\use_package amsmath 2
\use_package amssymb 0
\use_package cancel 0
\use_package esint 1
\use_package mathdots 0
\use_package mathtools 0
\use_package mhchem 0
\use_package stackrel 0
\use_package stmaryrd 0
\use_package undertilde 0
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
MultiGWAS: An integrative tool for Genome Wide Association Studies (GWAS) in tetraploid organisms
\end_layout

\begin_layout Author
[
\end_layout

\begin_layout Standard
1]
\begin_inset ERT
status collapsed

\begin_layout Plain Layout
{
\end_layout

\end_inset

L. Garreta
\begin_inset ERT
status collapsed

\begin_layout Plain Layout
}
\end_layout

\end_inset

 
\end_layout

\begin_layout Author
[
\end_layout

\begin_layout Standard
1]
\begin_inset ERT
status collapsed

\begin_layout Plain Layout
{
\end_layout

\end_inset

I. Cerón-Souza
\begin_inset ERT
status collapsed

\begin_layout Plain Layout
}
\end_layout

\end_inset

 
\end_layout

\begin_layout Author
[
\end_layout

\begin_layout Standard
2]
\begin_inset ERT
status collapsed

\begin_layout Plain Layout
{
\end_layout

\end_inset

M.R. Palacio
\begin_inset ERT
status collapsed

\begin_layout Plain Layout
}
\end_layout

\end_inset

 
\end_layout

\begin_layout Author
[
\end_layout

\begin_layout Standard
1]
\begin_inset ERT
status collapsed

\begin_layout Plain Layout
{
\end_layout

\end_inset

P.H. Reyes-Herrera
\begin_inset ERT
status collapsed

\begin_layout Plain Layout
}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

\backslash
affil
\end_layout

\end_inset

[1]
\begin_inset ERT
status collapsed

\begin_layout Plain Layout
{
\end_layout

\end_inset

Corporación Colombiana de Investigación Agropecuaria (AGROSAVIA), CI Tibaitatá, Kilómetro 14, Vía a Mosquera, 250047, Colombia
\begin_inset ERT
status collapsed

\begin_layout Plain Layout
}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

\backslash
affil
\end_layout

\end_inset

[2]
\begin_inset ERT
status collapsed

\begin_layout Plain Layout
{
\end_layout

\end_inset

Corporación Colombiana de Investigación Agropecuaria (AGROSAVIA), CI El Mira, Kilómetro 38, Vía Tumaco Pasto, Colombia
\begin_inset ERT
status collapsed

\begin_layout Plain Layout
}
\end_layout

\end_inset


\end_layout

\begin_layout Abstract

\series bold
Summary:
\series default
 The Genome-Wide Association Studies (GWAS) are essential to determine the genetic bases of either ecological or economic phenotypic variation across individuals within populations of model and non-model organisms. For this research question, current practice is the replication of the GWAS testing different parameters and models to validate the reproducibility of results. However, straightforward methodologies that manage both replication and tetraploid data are still missing. To solve this problem, we designed the MultiGWAS, a tool that does GWAS for diploid and tetraploid organisms by executing in parallel four software, two for polyploid data (GWASpoly and SHEsis) and two for diploids data (PLINK and TASSEL). MultiGWAS has several advantages. It runs either in the command line or in an interface. It manages different genotype formats, including VCF. It executes both the full and naïve models using several quality filters. Besides, it calculates a score to choose the best gene action model across GWASPoly and TASSEL. Finally, it generates several reports that facilitate the identification of false associations from both the significant and the best-ranked association SNP among the four software. We tested MultiGWAS with tetraploid potato data. The execution demonstrated that the Venn diagram and the other companion reports (i.e., Manhattan and QQ plots, heatmaps for associated SNP profiles, and chord diagrams to trace associated SNP by chromosomes) were useful to identify associated SNP shared among different models and parameters. Therefore, we confirmed that MultiGWAS is a suitable wrapping tool that successfully handles GWAS replication in both diploid and tetraploid organisms. 
\begin_inset Newline newline
\end_inset

 
\series bold
Contact:
\series default
 phreyes@agrosavia.co
\begin_inset Newline newline
\end_inset

 
\series bold
Keywords: GWAS on polyploids, GWASPoly, PLINK, SNP, SHEsis, software, TASSEL
\series default
 
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
The Genome-Wide Association Studies (GWAS) comprise statistical tests that identify which variants through the whole genome of a large number of individuals are associated with a specific trait (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "cantor2010prioritizing,begum2012comprehensive"

\end_inset

). This methodology started with humans and several model plants, such as rice, maize, and 
\emph on
Arabidopsis
\emph default
 (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "lauc2010genomics,tian2011genome,cao2011whole,korte2013advantages,han2013sequencing"

\end_inset

). Because of the advances in the next-gen sequencing technology and the decline of the sequencing cost in recent years, there is an increase in the availability of genome sequences of different organisms at a faster rate (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "ekblom2011applications,ellegren2014genome"

\end_inset

). Thus, the GWAS is becoming the standard tool to understand the genetic bases of either ecologically or economically relevant phenotypic variation for both model and non-model organisms. This increment includes complex species such as polyploids (Fig. 
\begin_inset CommandInset ref
LatexCommand ref
reference "GWASpolyploids"

\end_inset

) (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "ekblom2011applications,santure2018wild"

\end_inset

).
\end_layout

\begin_layout Standard

\begin_inset Float figure
placement H
wide false
sideways false
status open


\begin_layout Standard
\align center

\begin_inset Graphics 
	filename 01_figure-GWASpolyploids-PubMed.pdf

\end_inset

 
\end_layout

\begin_layout Standard

\begin_inset Caption Standard

\begin_layout Plain Layout
The number of peer-reviewed papers that contains the keywords "GWAS" and "polyploid" in the PubMed database between 2009 and 2019.
\begin_inset CommandInset label
LatexCommand label
name "GWASpolyploids"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The GWAS for polyploid species has fourth related challenges. First, replication is critical to validate GWAS results and capture real associations.This approach involved using different parameters, models, or conditions to test how consistent the results are in the same software or different GWAS tools (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "De2014,Pearson2008"

\end_inset

). However, the performance of different GWAS software could affect the results. For example, the significance threshold for 
\begin_inset Formula $pvalue$
\end_inset

 changes through four GWAS software (i.e., PLINK, TASSEL, GAPIT, and FaST-LMM) when the sample size varies (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Yan2019"

\end_inset

). It means that well-ranked SNPs from one package can be ranked differently in another.
\end_layout

\begin_layout Standard
Second, there are very few tools focused on the integration of several GWAS software, to make comparisons under different parameters and conditions across them. As far as we are aware, there is only two software with this service in mind, which are iPAT and easyGWAS.
\end_layout

\begin_layout Standard
The iPAT allows running in a graphic interface three well-known command-line GWAS software such as GAPIT, PLINK, and FarmCPU (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Zhang2018"

\end_inset

). However, the output from each package is separated. On the other hand, the easyGWAS allows running a GWAS analysis on the web using different algorithms and combining several GWAS results. This analysis runs independently of both the computer capacity and the operating system. Nevertheless, it needs either several datasets to obtain the different GWAS results to make replicates or GWAS results already computed. In either case, the results from different algorithms are also separated (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Grimm2017"

\end_inset

). Thus, although both software iPAT and easyGWAS integrate with different programs or algorithms, an output that allows them to compare similitudes and differences in the association is missing.
\end_layout

\begin_layout Standard
Third, although there are different GWAS software available to repeat the analysis under different conditions (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Gumpinger2018"

\end_inset

), most of them are designed exclusively for the diploid data matrix (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Bourke2018"

\end_inset

). Therefore, it is often necessary to "diploidizing" the polyploid genomic data in order to replicate the analysis. The main consequence of this process is missing the complexity of polyploid data to understand how allele dosage affects the phenotype expression (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Ferrao2018"

\end_inset

).
\end_layout

\begin_layout Standard
Finally, for polyploid species, any tool that integrates and compares different gene action among software is key to understanding how redundancy or complex interaction among alleles affects the phenotype expression and the evolution of new phenotypes (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Bourke2018,Rosyara2016,Ferrao2018"

\end_inset

).
\end_layout

\begin_layout Standard
To overcome these challenges, we developed the MultiGWAS tool that performs GWAS analyses for both diploid and tetraploid species using four software in parallel. Our tool includes GWASpoly (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Rosyara2016"

\end_inset

) and the SHEsis tool (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Shen2016"

\end_inset

) that accept polyploid genomic data, and PLINK (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Purcell2007"

\end_inset

) and TASSEL (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Bradbury2007"

\end_inset

), designed exclusively for diploids, but that in the case of tetraploid data, their use require "diploidizing" genomic matrix. This wrapping tool deals with different input file formats, including VCF. Besides, manage data preprocessing, search for associations by running four GWAS software in parallel, and create a score to choose between gene action models in GWASPoly and TASSEL. Moreover, create comparative reports from the output of each software to help the user distinguish genuine associations from false positives.
\end_layout

\begin_layout Section
Method
\end_layout

\begin_layout Standard
The MultiGWAS tool has three main consecutive steps: the adjustment, the multi analysis, and the integration (Fig. 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Pipeline"

\end_inset

). In the adjustment step, MultiGWAS processes the configuration file. Then it cleans and filters the genotype and phenotype datasets, and in case of tetraploids, MultiGWAS "diploidize" the genomic data. Next, during the multi analysis, each GWAS tool runs in parallel. Subsequently, in the integration step, the MultiGWAS tool scans the output files from the four packages (i.e., GWASPoly, SHEsis, PLINK, and TASSEL). Finally, it generates a summary of all results that contains score tables, Venn diagrams, SNP profiles, and Manhattan plots. 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout
% Figure MultiGWAS stages
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open


\begin_layout Standard

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

\backslash
centering
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout
{}
\end_layout

\end_inset


\begin_inset Graphics 
	filename 02_figure-multiGWAS-flowchart-stages.pdf
	width 12cm

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout

\series bold
MultiGWAS flowchart has three steps: adjustment, multi analysis, and integration.
\series default
 In the first step, after the input data management upload, MultiGWAS read the configuration file, and preprocessing the input data (genotype and phenotype dataset). The second step is the GWAS analysis, where MultiGWAS configure and run the four packages in parallel. Finally, in the third step, MultiGWAS summarize the results and generate a report using different tabular and graphical visualizations.
\begin_inset CommandInset label
LatexCommand label
name "fig: Pipeline"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Adjustment stage
\end_layout

\begin_layout Standard
MultiGWAS takes as input a configuration file where the user specifies the genomics data and the parameters used by the four tools. Once the configuration file is read and processed, the genomic data files (genotype and phenotype) are then cleaned, filtered, and checked for data quality. The output of this stage corresponds to the inputs for the four programs at the Multi Analysis stage.
\end_layout

\begin_layout Subsubsection
Reading configuration file
\begin_inset CommandInset label
LatexCommand label
name "section-Reading-configuration-file"

\end_inset


\end_layout

\begin_layout Standard
The configuration file includes the following settings that we briefly describe:
\end_layout

\begin_layout Paragraph

\begin_inset ERT
status collapsed

\begin_layout Plain Layout
{
\end_layout

\end_inset

Ploidy:
\begin_inset ERT
status collapsed

\begin_layout Plain Layout
}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Numerical value for the ploidy level of the genotype, currently MultiGWAS supports diploids and tetraploids genotypes (2: for diploids, 4: for tetraploids).
\end_layout

\begin_layout Standard

\begin_inset ERT
status collapsed

\begin_layout Plain Layout
% Preview source code from paragraph 22 to 24
\end_layout

\end_inset


\end_layout

\begin_layout Paragraph
Genotype and phenotype input files:
\end_layout

\begin_layout Standard
MultiGWAS uses two input files, one for the genotype and one for the phenotype. Genotype data can be input in three different formats, including a matrix format (Fig. 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:File-Formats"

\end_inset

.a), a GWASpoly format (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Rosyara2016"

\end_inset

) (Fig. 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:File-Formats"

\end_inset

.b), and Variant Call Format (VCF) (Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:File-Formats"

\end_inset

.c) which is transformed into GWASpoly format using NGSEP 4.0.2 (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Duitama2019"

\end_inset

). The phenotype file contains only one trait with the first column for the sample names and the second column for the trait values (Fig. 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:File-Formats"

\end_inset

.d).
\end_layout

\begin_layout Standard

\begin_inset Float figure
placement H
wide false
sideways false
status open


\begin_layout Standard
\align center

\begin_inset Graphics 
	filename 03_figure-input-files.pdf

\end_inset

 
\end_layout

\begin_layout Standard

\begin_inset Caption Standard

\begin_layout Plain Layout

\series bold
Examples of MultiGWAS input file formats
\series default
. Figures a, b and c show examples of genotypes, while figure d shows an example of a phenotype. 
\series bold
a
\series default
. Genotype file in matrix format containing in the first column the marker names and in the following columns the marker data of the samples coded in "ACGT" format (e.g. AAGG, CCTT for tetraploids, AG, CT for diploids). 
\series bold
b
\series default
. Genotype file in GWASpoly format adding the chromosome and marker position to the matrix format.
\series bold
c
\series default
. Genotype file in VCF format with metadata (first two lines) and header line. The following lines contain genotype information of the samples for each position. VCF marker data can be encoded as simple genotype calls (GT format field, e.g., 0/0/1/1 for tetraploids or 0/1 for diploids) or using the NGSEP custom format fields (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Duitama2019"

\end_inset

): ACN, ADP or BSDP. 
\series bold
d
\series default
. Phenotype file in a matrix format with column headers and sample names followed by their trait values. Both GWASpoly genotype and phenotype files are in CSV (Comma Separated Values format).
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:File-Formats"

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

\backslash
protect
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Paragraph
GWAS model:
\end_layout

\begin_layout Standard
MultiGWAS is designed to work with quantitative phenotypes and can run GWAS analysis using two types of statistical models that we have called 
\emph on
full
\emph default
 and 
\emph on
naive
\emph default
 models. The 
\emph on
full model
\emph default
 is known in the literature as the Q+K model (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Yu2006"

\end_inset

) and includes a control for structure (Q) and relatedness between samples (K). In contrast, the 
\emph on
naive model
\emph default
 does not include any type of correction. Both models are linear regression approaches, and each one of the four GWAS packages used in MultiGWAS has some variations of those models. The 
\emph on
naive
\emph default
 is modeled with Generalized Linear Models (GLMs, Phenotype + Genotype), and the 
\emph on
full
\emph default
 is modeled with Mixed Linear Models (MLMs, Phenotype + Genotype + Structure + Kinship). The default model used by MultiGWAS is the 
\emph on
full model
\emph default
 (Q+K) (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Yu2006"

\end_inset

), following the equation:
\end_layout

\begin_layout Standard

\begin_inset Formula \[
y=X\beta+S\alpha+Q\nu+Z\mu+e
\]
\end_inset


\end_layout

\begin_layout Standard
In this equation, the 
\begin_inset Formula $y$
\end_inset

 is the vector of observed phenotypes. Moreover, the 
\begin_inset Formula $\beta$
\end_inset

 is a vector of fixed effects other than SNP or population group effects, the 
\begin_inset Formula $\alpha$
\end_inset

 is a vector of SNP effects (Quantitative Trait Nucleotides), the 
\begin_inset Formula $\nu$
\end_inset

 is a vector of population effects, the 
\begin_inset Formula $\mu$
\end_inset

 is a vector of polygene background effects, and the 
\begin_inset Formula $e$
\end_inset

 is a vector of residual effects. Besides, 
\begin_inset Formula $Q$
\end_inset

, modeled as a fixed effect, refers to the incidence matrix for subpopulation covariates relating 
\begin_inset Formula $y$
\end_inset

 to 
\begin_inset Formula $\nu$
\end_inset

, and 
\begin_inset Formula $X$
\end_inset

, 
\begin_inset Formula $S$
\end_inset

 and 
\begin_inset Formula $Z$
\end_inset

 are incidence matrices of 1s and 0s relating 
\begin_inset Formula $y$
\end_inset

 to 
\begin_inset Formula $\beta$
\end_inset

, 
\begin_inset Formula $\alpha$
\end_inset

 and 
\begin_inset Formula $\mu$
\end_inset

, respectively.
\end_layout

\begin_layout Paragraph
Genome-wide significance: 
\end_layout

\begin_layout Standard
GWAS searches SNPs associated with the phenotype in a statistically significant manner. A threshold or significance level 
\begin_inset Formula $\alpha$
\end_inset

 is specified and compared with the 
\emph on
p-value
\emph default
 derived for each association score. Standard significance levels are 0.01 or 0.05 (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Gumpinger2018,Rosyara2016"

\end_inset

), and MultiGWAS uses an 
\begin_inset Formula $\alpha$
\end_inset

 of 0.05 for the four GWAS packages. However, in GWASpoly and TASSEL, which calculates the SNP effect for each genotypic class using different gene action models (see 
\begin_inset Quotes eld
\end_inset

Multi analysis stage
\begin_inset Quotes erd
\end_inset

), the threshold is adjusted according to each of those two packages. Therefore, the number of tested markers
\emph on
 
\emph default
may be different in each model (see below), impacting the 
\emph on
p-value
\emph default
 thresholds.
\end_layout

\begin_layout Paragraph
Multiple testing correction:
\end_layout

\begin_layout Standard
Due to the massive number of statistical tests performed by GWAS, it is necessary to perform a correction method for multiple hypothesis testing and adjusting the 
\emph on
p-value
\emph default
 threshold accordingly. Two standard methods for multiple hypothesis testing are the false discovery rate (FDR) and the Bonferroni correction. The latter is the default method used by MultiGWAS, which is one of the most rigorous methods. However, instead of adjusting the 
\emph on
p-values,
\emph default
 MultiGWAS adjust the threshold below which a 
\emph on
p-value
\emph default
 is considered significant. That is 
\begin_inset Formula $\alpha/m$
\end_inset

, where 
\begin_inset Formula $\alpha$
\end_inset

 is the significance level and 
\emph on
m 
\emph default
is the number of tested markers from the genotype matrix.
\end_layout

\begin_layout Paragraph
Number of reported associations: 
\end_layout

\begin_layout Standard
Criticism has arisen, considering only statistically significant associations as possible correct associations (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Thomson2011, Kaler2019"

\end_inset

). Many low 
\emph on
p-value
\emph default
 associations, closer to being significant, are discarded due to the stringent significance levels, which consequently increases the number of false negatives. To avoid this problem, MultiGWAS provides the option to specify the number of best-ranked associations (lower 
\emph on
p-values
\emph default
), adding the corresponding 
\emph on
p-value
\emph default
 to each association found. In this way, it is possible to enlarge the number of results, and their replicability across the different programs. Nevertheless, the report displays each association with its corresponding 
\emph on
p-value
\emph default
.
\end_layout

\begin_layout Standard

\begin_inset ERT
status collapsed

\begin_layout Plain Layout
%  We present the resultant associations in different tables and graphics reported by MultiGWAS (see Figure 
\backslash
ref{fig:-View-Shared-SNPs}). 
\end_layout

\end_inset


\end_layout

\begin_layout Paragraph
Quality control filters:
\end_layout

\begin_layout Standard
A control step is necessary to check the input data for the genotype or phenotype errors or poor quality that can lead to spurious GWAS results. MultiGWAS provides the option to select and define thresholds for the following filters that control the data quality: Minor Allele Frequency (MAF), individual missing rate (MIND), SNP missing rate (GENO), and Hardy-Weinberg threshold (HWE): 
\end_layout

\begin_layout Itemize

\series bold
MAF of 
\series default

\series bold

\emph on
x:
\emph default

\series default
 filters out SNPs with minor allele frequency below 
\emph on
x
\emph default
 (default 0.01); 
\end_layout

\begin_layout Itemize

\series bold
MIND of 
\series default

\series bold

\emph on
x:
\emph default

\series default
 filters out all individuals with missing genotypes exceeding 
\emph on
x
\emph default
*100% (default 0.1); 
\end_layout

\begin_layout Itemize

\series bold
GENO of 
\series default

\series bold

\emph on
x:
\emph default

\series default
 filters out SNPs with missing values exceeding 
\emph on
x
\emph default
*100% (default 0.1); 
\end_layout

\begin_layout Itemize

\series bold
HWE of 
\series default

\series bold

\emph on
x:
\emph default

\series default
 (for diploids) filters out SNPs with a 
\emph on
p-value
\emph default
 below the 
\emph on
x
\emph default
 threshold in the Hardy-Weinberg equilibrium exact test.
\end_layout

\begin_deeper
\begin_layout Standard

\begin_inset ERT
status collapsed

\begin_layout Plain Layout
%
\backslash
ic{Comentario de Andrés: una pregunta más metodológica tiene que ver con HWE. en poliploides la hetrocigosidad está inflada, y por ello desviaría en HWE si esté se calcula tradicionalmente. por ello, son las fercuencias genotípicas esperadas calculadas para poliplodes? i.e. (p+q) elevado a la n donde n es la ploidía}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
MultiGWAS does the MAF filtering, and uses the PLINK package (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Gumpinger2018"

\end_inset

) for the other three filters: MIND, GENO, and HWE.
\end_layout

\begin_layout Paragraph

\begin_inset ERT
status collapsed

\begin_layout Plain Layout
{
\end_layout

\end_inset

GWAS tools:
\begin_inset ERT
status collapsed

\begin_layout Plain Layout
}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
List of names of the four GWAS software to run and integrate into MultiGWAS analysis. They are GWASpoly and SHEsis (designed for polyploid data), and PLINK and TASSEL (designed for diploid data).
\end_layout

\begin_layout Subsubsection
Data preprocessing
\end_layout

\begin_layout Standard
Once the configuration file is processed, the genomic data is read and cleaned by selecting individuals present in both genotype and phenotype. Then, MultiGWAS removes individuals and SNPs with poor quality following the previous selected quality-control filters and their thresholds,
\end_layout

\begin_layout Standard
At this point, the format "ACGT" suitable for the polyploid software GWASpoly and SHEsis, is "diploidized" for PLINK and TASSEL. The homozygous tetraploid genotypes are converted to diploid thus: AAAA→AA, CCCC→CC, GGGG→GG, TTTT→TT. Moreover, for tetraploid heterozygous genotypes, the conversion depends on the reference and alternate alleles calculated for each position (e.g., AAAT →AT, ... ,CCCG→CG).
\end_layout

\begin_layout Standard
After this process, MultiGWAS converts the genomic data, genotype, and phenotype datasets to the specific formats required for each of the four GWAS packages.
\end_layout

\begin_layout Subsection
Multi analysis stage
\end_layout

\begin_layout Standard
MultiGWAS runs in parallel using two types of statistical models specified in the parameters file, the Full model (Q+K) and Naive (i.e., without any control) where Q refers to population structure, and K refers to relatedness, calculated by kinship coefficients across individuals (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Sharma2018"

\end_inset

). The Full model (Q+K) controls for both population structure and individual relatedness. For population structure, MultiGWAS uses the Principal Component Analysis (PCA) and takes the top five PC as covariates. For relatedness, MultiGWAS uses kinship matrices that TASSEL and GWASpoly calculated separately, and for PLINK and SHEsis, relatedness depends on kinship coefficients calculated with the PLINK 2.0 built-in algorithm (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Chang2015"

\end_inset

).
\end_layout

\begin_layout Subsubsection
GWASpoly
\begin_inset CommandInset label
LatexCommand label
name "subsec_GWASpoly"

\end_inset


\end_layout

\begin_layout Standard

\begin_inset ERT
status collapsed

\begin_layout Plain Layout
%Editado y revisado por Ivania el 5 de junio
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

GWASpoly (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Rosyara2016"

\end_inset

) is an R package designed for GWAS in polyploid species used in several studies in plants (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Berdugo2017, Ferrao2018, Sharma2018, Yuan2019"

\end_inset

). GWASpoly uses a Q+K linear mixed model with biallelic SNPs that account for population structure and relatedness. Also, to calculate the SNP effect for each genotypic class, GWASpoly provides eight gene action models: general, additive, simplex dominant alternative, simplex dominant reference, duplex dominant alternative, duplex dominant, diplo-general, and diplo-additive. Consequently, the number of statistical tests performed can be different in each action model and so thresholds below which the 
\emph on
p-values
\emph default
 are considered significant.
\end_layout

\begin_layout Standard
MultiGWAS is using GWASpoly version 1.3 with all gene action models available to find associations. The MultiGWAS reports the top 
\emph on
N
\emph default
 best-ranked (the SNPs with lowest 
\emph on
p-values
\emph default
) that the user specified in the 
\emph on
N
\emph default
 input configuration file. The 
\emph on
full 
\emph default
model used by GWASpoly includes the population structure and relatedness, which are estimated using the first five principal components and the kinship matrix, respectively, both calculated with the GWASpoly built-in algorithms.
\end_layout

\begin_layout Subsubsection
SHEsis
\end_layout

\begin_layout Standard
SHEsis is a program based on a linear regression model that includes single-locus association analysis, among others. The software design includes polyploid species. However, their use is mainly in diploids animals and humans (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Qiao2015, Meng2019"

\end_inset

).
\end_layout

\begin_layout Standard
MultiGWAS is using version 1.0, which does not take account for population structure or relatedness. Despite, MultiGWAS externally estimates relatedness for SHEsis by excluding individuals with cryptic first-degree relatedness using the algorithm implemented in PLINK 2.0 (see below).
\end_layout

\begin_layout Subsubsection
PLINK
\end_layout

\begin_layout Standard
PLINK is one of the most extensively used programs for GWAS in humans and any diploid species (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Power2016"

\end_inset

). PLINK includes a range of analyses, including univariate GWAS using two-sample tests and linear regression models.
\end_layout

\begin_layout Standard
MultiGWAS is using two versions of PLINK: 1.9 and 2.0. Linear regression from PLINK 1.9 performs both naive and full model. For the full model, the software calculates the population structure using the first five principal components calculated with a built-in algorithm integrated into version 1.9. Moreover, version 2.0 calculates the kinship coefficients across individuals using a built-in algorithm that removes the close individuals with the first-degree relatedness.
\end_layout

\begin_layout Subsubsection
TASSEL
\begin_inset CommandInset label
LatexCommand label
name "subsec_TASSEL"

\end_inset


\end_layout

\begin_layout Standard
TASSEL is another standard GWAS program based on the Java software developed initially for maize but currently used in several species (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Alvarez2017, Zhang2018"

\end_inset

). For the association analysis, TASSEL includes the general linear model (GLM) and mixed linear model (MLM) that accounts for population structure and relatedness. Moreover, as GWASPoly, TASSEL provides three-gene action models to calculate the SNP effect of each genotypic class: general, additive, and dominant. Hence, the significance threshold depends on each action model.
\end_layout

\begin_layout Standard
MultiGWAS uses TASSEL 5.0, with all gene action models used to find the 
\emph on
N
\emph default
 best-ranked associations and reporting the top 
\emph on
N
\emph default
 best-ranked associations (SNPs with lowest 
\emph on
p-values
\emph default
). Naive GWAS uses the GLM, and full GWAS uses the MLM with two parameters: population structure that uses the first five principal components, and relatedness that uses the kinship matrix with centered IBS method, both calculated with the TASSEL built-in algorithms.
\end_layout

\begin_layout Subsection
Integration stage.
\end_layout

\begin_layout Standard
The outputs resulting from the four GWAS packages are scanned and processed to identify significant and best-ranked associations with 
\emph on
p-values
\emph default
 lower than and close to a significance threshold, respectively.
\end_layout

\begin_layout Subsubsection
Calculation of 
\emph on
p-values 
\emph default
and significance thresholds
\end_layout

\begin_layout Standard
GWAS packages compute 
\emph on
p-value 
\emph default
as a measure of association between each SNP and the trait of interest. The statistically significant associations are those their 
\emph on
p-value 
\emph default
drops below a predefined significance threshold. Since a GWAS analysis performs a large number of tests to look for possible associations, one for each SNP, then some correction in the 
\emph on
p-values
\emph default
 is needed to reduce the possibility of identifying false positives, or SNPs with false associations with the phenotype, but that reach the significance threshold.
\end_layout

\begin_layout Standard
MultiGWAS provides two methods for adjusting 
\emph on
p-values
\emph default
 and significance threshold: the false discovery rate (FDR) that adjust 
\emph on
p-values, 
\emph default
and the Bonferroni correction, that adjusts the threshold. By default, MultiGWAS uses the Bonferroni correction that uses the significance level 
\begin_inset Formula $\alpha/m$
\end_inset

, with 
\begin_inset Formula $\alpha$
\end_inset

 defined by the user in the configuration file, and 
\begin_inset Formula $m$
\end_inset

 is the number of tested markers to adjust the significance threshold in the GWAS study.
\end_layout

\begin_layout Standard
However, the significance threshold can be different for each GWAS package as some of them use several action models to calculate the SNP effect of each genotypic class. For both PLINK and SHEsis packages, which use only one model, 
\begin_inset Formula $m$
\end_inset

 is equal to the total number of SNPs. However, for both GWASpoly and TASSEL packages, which use eight and three gene action models, respectively, 
\begin_inset Formula $m$
\end_inset

 is equal to the number of tests performed in each model, which is different between models.
\end_layout

\begin_layout Standard
Furthermore, most GWAS packages compute both 
\emph on
p-values
\emph default
 and thresholds differently, with the consequence that significant associations identified by one package do not reach the threshold of significance in the others. Thus, it could result in the loss of real associations, the so-called false negatives. To overcome these difficulties, MultiGWAS reports two sets of associations: significant and best-ranked (those closest to being statistically significant), as described below.
\end_layout

\begin_layout Subsubsection
Selection of significant and best-ranked associations
\end_layout

\begin_layout Standard
MultiGWAS reports two groups of associations from the results of the four GWAS packages: the statistically significant associations with 
\emph on
p-values
\emph default
 below a threshold of significance, and the best-ranked associations with the lowest 
\emph on
p-values
\emph default
, but not reaching the limit to be statistically significant. However, they are representing interesting associations for further analysis (possible false negatives).
\end_layout

\begin_layout Standard
PLINK and SHEsis have a unique gene action model (see section 2.2.2 and 2.2.3). However, in the case of GWASpoly and TASSEL, which have eight and three models respectively, MultiGWAS automatically selects the "best gene action model" from each package and takes the associations from it. This selection within GWASPoly and TASSEL has three criteria: the inflation factor (I), the shared SNPs (R), and the significant SNPs (S).
\end_layout

\begin_layout Standard
Each gene action model is scored using the following equation: 
\end_layout

\begin_layout Standard
\align center

\begin_inset Formula $score(M_{i})=I{}_{i}+R_{i}+S{}_{i}$
\end_inset

 
\end_layout

\begin_layout Standard
where 
\begin_inset Formula $score(M_{i})$
\end_inset

 is the score for the gene action model 
\begin_inset Formula $M_{i}$
\end_inset

, with 
\begin_inset Formula $i$
\end_inset

 from 
\begin_inset Formula $1..k$
\end_inset

, for a GWAS package with 
\begin_inset Formula $k$
\end_inset

 gene action models. 
\begin_inset Formula $I_{i}$
\end_inset

 is the score for the inflation factor defined as 
\begin_inset Formula $I_{i}=1-|1-\lambda(M_{i})|$
\end_inset

, where 
\begin_inset Formula $\lambda(M_{i})$
\end_inset

 is the inflation factor for the 
\begin_inset Formula $M_{i}$
\end_inset

 model. 
\begin_inset Formula $R_{i}$
\end_inset

 is the score of the shared SNPs defined as 
\begin_inset Formula $R_{i}=\sum\limits _{j=1}^{k}{\textstyle |M_{i}\sim M_{j}|}$
\end_inset

, where 
\begin_inset Formula ${\textstyle |M_{i}\sim M_{j}|}$
\end_inset

 is the number of SNPs shared between 
\begin_inset Formula $M_{i}$
\end_inset

 and 
\begin_inset Formula $M_{j}$
\end_inset

 models, normalized by the maximum number of SNPs shared between all models. And, 
\begin_inset Formula $S_{i}$
\end_inset

 is the number of significant SNPs of model 
\begin_inset Formula $M_{i}$
\end_inset

 normalized by the total number SNPs shared among all models.
\end_layout

\begin_layout Standard
The score is high when an 
\begin_inset Formula $M_{i}$
\end_inset

 model has an inflation factor 
\begin_inset Formula $\lambda$
\end_inset

 close to 1, identifies a high number of shared SNPs, and contains one or more significant SNPs. Conversely, the score is low when the 
\begin_inset Formula $M_{i}$
\end_inset

 model has an inflation factor 
\begin_inset Formula $\lambda$
\end_inset

 either low (close to 0) or high (
\begin_inset Formula $\lambda>2$
\end_inset

 ), which identifies a small number of shared SNPs, and contains 0 or few significant SNPs. In any other case, the score results from the balance among the inflation factor, the number of shared SNPs, and the number of significant SNPs.
\end_layout

\begin_layout Subsubsection
Integration of results
\end_layout

\begin_layout Standard

\begin_inset Float figure
wide false
sideways false
status open


\begin_layout Standard

\begin_inset Graphics 
	filename 04_figure-methodologies-all-plots.pdf
	width 11cm

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout

\series bold
Reports presented by MultiGWAS
\series default
. For each tool, first, a QQ plot that assesses the resultant 
\emph on
p-values
\emph default
. Second, a Manhattan plot for each tool with two lines, blue and red, represents the lower limit for the best ranked and significative SNPs, respectively. We present two Venn diagrams, one for the significative SNPs and one for N best-ranked SNPs of each tool. We show the results for GWAspoly, PLINK, TASSEL, and SHEsis in red, green, yellow, and blue. For each SNP that is in the intersection, thus, that is predicted by more than one tool, we provide an SNP profile. SNPs by chromosome chord diagrams show that the strongest associations are limited to few chromosomes. Furthermore, we present tabular summaries with details of significant and best-ranked associations.
\begin_inset CommandInset label
LatexCommand label
name "fig: Reports"

\end_inset

 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
At this stage, MultiGWAS integrates the results to evaluate reproducible results among tools (Fig 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Reports"

\end_inset

). However, it still reports a summary of the results of each tool: 
\end_layout

\begin_layout Itemize
A Quantile-Quantile (QQ) plots for the resultant 
\emph on
p-values
\emph default
 of each tool and the corresponding inflation factor 
\begin_inset Formula $\lambda$
\end_inset

 to assess the degree of the test statistic inflation. 
\end_layout

\begin_layout Itemize
A Manhattan plot of each tool with two lower thresholds, one for the best-ranked SNPs, and another for the significant SNPs. 
\end_layout

\begin_layout Standard
To present the replicability, we use two sets: (1) the set of all the significative SNPs provided by each tool and (2) the set of all the best-ranked SNPs. For each set, we present a Venn diagram that displays all SNPs predicted exclusively by one tool and intersections that help identify the SNPs predicted by one, two, three, or all the tools. Also, this information is present on the tables for the two sets.
\end_layout

\begin_layout Standard
For each SNP identified more than once, MultiGWAS provides its SNP profile. That is a heat diagram for a specific SNP, where each column is a genotype state AAAA, AAAB, AABB, ABBB, and BBBB. Moreover, each row corresponds to a sample. Samples with close genotypes form together clusters. Thus to generate the clusters, we do not use the phenotype information. However, we present the phenotypic information in the figure as the color. This figure visually provides information regarding genotype and phenotype information simultaneously for the whole population. We present colors as tones between white and black for color blind people.
\end_layout

\begin_layout Standard
MultiGWAS generates a report, one document with the content previously described. Besides, there is a folder with the individual figures just in case the user needs one (Supplementary Material 1).
\end_layout

\begin_layout Standard
In the following section, we present the results of the functionality of the tool, configured with a Full GWAS model using quality filters, and applied on an open dataset of a diversity panel of a tetraploid potato, genotyped and phenotyped as part of the USDA-NIFA Solanaceae Coordinated Agricultural Project (SolCAP) 
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Hirsch2013"

\end_inset

. The complete report of this analysis and the report of a second analysis using a naive GWAS model without quality filters are presented in the supplementary materials S1 and S2, respectively.
\end_layout

\begin_layout Section
Results
\end_layout

\begin_layout Standard
All four GWAS packages adopted by MultiGWAS use linear regression approaches. However, they often produce different association results for the same input. Computed 
\emph on
p-values 
\emph default
for the same set of SNPs are different between packages. Therefore, SNPs with significant 
\emph on
p-values
\emph default
 for one package maybe not significant for the others. Alternatively, well-ranked SNPs in one package may be ranked differently in another.
\end_layout

\begin_layout Standard
To highlight these differences in the results across the four packages, MultiGWAS produces five types of results combining graphics and tables to compare, select, and interpret the set of possible SNPs associated with a trait of interest. The outputs include: 
\end_layout

\begin_layout Itemize
Manhattan and Q-Q plots to show GWAS associations. 
\end_layout

\begin_layout Itemize
Venn diagrams to show associations identified by single or several tools. 
\end_layout

\begin_layout Itemize
Heat diagrams to show the genotypic structure of shared SNPs. 
\end_layout

\begin_layout Itemize
Chord diagrams to show shared SNPs by chromosomes. 
\end_layout

\begin_layout Itemize
Score tables to show detailed information of associations for both summary results from MultiGWAS and particular results from each GWAS package 
\end_layout

\begin_layout Standard
The complete reports generated by MultiGWAS for both types of analysis, full and naive, applied to the diversity panel of tetraploid potato, are supplementary information at 
\begin_inset space ~

\end_inset

 
\begin_inset Flex Flex:URL
status collapsed

\begin_layout Plain Layout
https://github.com/agrosavia-bioinformatics/MultiGWAS/tree/master/docs/supplements
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard

\begin_inset ERT
status collapsed

\begin_layout Plain Layout
% Preview source code from paragraph 103 to 107
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Manhattan and QQ plots for GWAS associations 
\end_layout

\begin_layout Standard
MultiGWAS uses classical Manhattan and Quantile–Quantile plots (QQ plots) to visualize each package's results. In both plots, the points are the SNPs and their p-values are transformed into scores like 
\begin_inset Formula $-log_{10}(\mathB{p-values})$
\end_inset

 (see Fig. 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:view-qqmanhattan"

\end_inset

). The Manhattan plot shows the strength of association of the SNPs (y-axis) distributed at their genomic location (x-axis), so the higher the score, the stronger the association. At the same time, the QQ plot compares the expected distribution of 
\emph on
p-values
\emph default
 (y-axis) with the observed distribution (x-axis).
\end_layout

\begin_layout Standard
MultiGWAS adds distinctive marks to both plots to identify different types of SNPs: (a) In the Manhattan plots, the significant SNPs are above a red line, and the best-ranked SNPs are above a blue line. Also, SNPs shared between packages are colored green (See Fig. 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Table-Shared-SNPs"

\end_inset

.b). (b) In the QQ plots, a red diagonal line indicates the expected distribution under the null hypothesis of no association of SNPs with the phenotype. Both distributions should coincide, and most SNPs should lie on the diagonal line. Deviations for a large number of SNPs may reflect inflated 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout
{
\end_layout

\end_inset


\emph on
p-values 
\emph default

\begin_inset ERT
status collapsed

\begin_layout Plain Layout
}
\end_layout

\end_inset

due to population structure or cryptic relatedness. Nevertheless, few SNPs deviate from the diagonal for a truly polygenetic trait (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Power2016"

\end_inset

).
\end_layout

\begin_layout Standard

\begin_inset Float figure
placement H
wide false
sideways false
status open


\begin_layout Standard
\align center

\begin_inset Graphics 
	filename 05_figure-manhattan-QQ-plots.pdf
	width 11cm

\end_inset

 
\end_layout

\begin_layout Standard

\begin_inset Caption Standard

\begin_layout Plain Layout

\series bold

\begin_inset ERT
status collapsed

\begin_layout Plain Layout
{
\end_layout

\end_inset

Associations in the tetraploid potato dataset.
\begin_inset ERT
status collapsed

\begin_layout Plain Layout
}
\end_layout

\end_inset


\series default
 MultiGWAS shows the associations identified by the four GWAS packages using Manhattan and QQ plots. The tetraploid potato data showed several SNPs shared between the four software (green dots). The best-ranked SNPs are above the blue line, but only GWASpoly and SHEsis identified significant associations (SNPs above the red line) for this dataset. However, the inflation factor given by SHEsis is too high (
\begin_inset Formula $\lambda=3.5$
\end_inset

, at the top of the QQ plot), which is observed by the high number of SNPs deviating from the red diagonal of the QQ plot. 
\begin_inset CommandInset label
LatexCommand label
name "fig:view-qqmanhattan"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard

\begin_inset ERT
status collapsed

\begin_layout Plain Layout
% Preview source code from paragraph 102 to 107
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Tables and Venn diagrams for single and shared SNPs
\end_layout

\begin_layout Standard
MultiGWAS provides tabular and graphic views to report the best-ranked and significant SNPs identified by the four GWAS packages in an integrative way (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Table-Shared-SNPs"

\end_inset

). Both 
\emph on
p-values
\emph default
 and significance levels have been scaled as 
\begin_inset Formula $-log_{10} (\mathB{p-values})$
\end_inset

 to give high scores to the best statistically evaluated SNPs.
\end_layout

\begin_layout Standard
First, best-ranked SNPs correspond to the top-scored 
\emph on
N
\emph default
 SNPs, whether they were assessed significant or not by its package, and with
\emph on
 N
\emph default
 defined by the user in the configuration file. These SNPs appears in both a SNPs table (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Table-Shared-SNPs"

\end_inset

.a), and in a Venn diagram (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Table-Shared-SNPs"

\end_inset

.b). The table lists them by package and sorts by decreasing score, whereas the Venn diagram emphasizes if they were best-ranked either in a single package or in several at once (shared).
\end_layout

\begin_layout Standard
Second, the significant SNPs correspond to the ones valued statistically significant by each package. They appear in a Venn diagram (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Table-Shared-SNPs"

\end_inset

.c), and in the SNPs table, marked with significance TRUE (T) in the table of the Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Table-Shared-SNPs"

\end_inset

.a.
\end_layout

\begin_layout Standard

\begin_inset Float figure
placement H
wide false
sideways false
status open


\begin_layout Standard
\align center

\begin_inset Graphics 
	filename 06_figure-table-venn-best.pdf
	width 11cm

\end_inset

 
\end_layout

\begin_layout Standard

\begin_inset Caption Standard

\begin_layout Plain Layout

\series bold
Shared SNPs Views.
\series default
 Tabular and graphical views of SNP associations identified by one or more GWAS packages (shared SNPs). SNPs identified by all packages are marker with red background in all figures. 
\series bold
a
\series default
 Table with details of the N=8 best-ranked SNPs from each GWAS package. Each row corresponds to a single SNP. 
\series bold
b
\series default
 Venn diagram of the best-ranked SNPs. SNPs identified by all packages are in the central intersection. Other shared SNPs are in both upper central and lower central intersections. 
\series bold
c
\series default
 Venn diagram of the significant SNPs (score 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

\backslash
textgreater
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout
{}
\end_layout

\end_inset

 threshold). 
\begin_inset CommandInset label
LatexCommand label
name "fig:Table-Shared-SNPs"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In this analysis, both the polyploid packages GWASpoly and SHEsis identified the SNPs c2_25471, c2_45611, and c1_8019. Of these SNPs, c1_8019 has been reported in previous studies to be associated with tuber shape and depth of eye traits (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Rosyara2016, Sharma2018"

\end_inset

). Furthermore, in another analysis of MultiGWAS using a naive model without filters (Supplemental Material S2), the SNP c1_8019 was co-identified by three packages: GWASpoly, SHEsis, and the diploid PLINK package.
\end_layout

\begin_layout Subsection
Heat diagrams for the structure of shared SNPs
\end_layout

\begin_layout Standard
MultiGWAS creates a two-dimensional representation, called the SNP profile, to visualize each trait by individuals and genotypes as rows and columns, respectively (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:SNP-profiles"

\end_inset

). At the left, the individuals are grouped in a dendrogram by their genotype. At the right, there is the name or ID of each individual. At the bottom, the genotypes are ordered from left to right, starting from the major to the minor allele (i.e., AAAA, AAAB, AABB, ABBB, BBBB). At the top, there is a description of the trait based on a histogram of frequency (top left) and an assigned color for each numerical phenotype value using a grayscale (top right). Thus, each individual appears as a colored line by its phenotype value on its genotype column. For each column, there is a solid cyan line with the mean of each column and a broken cyan line that indicates how far the cell deviates from the mean.
\end_layout

\begin_layout Standard
Because each multiGWAS report shows one specific trait at a time, the histogram and color key will remain the same for all the best-ranked SNPs.
\end_layout

\begin_layout Standard

\begin_inset Float figure
placement H
wide false
sideways false
status open


\begin_layout Standard
\align center

\begin_inset Graphics 
	filename 07_figure-heat-maps.pdf
	width 11cm

\end_inset

 
\end_layout

\begin_layout Standard

\begin_inset Caption Standard

\begin_layout Plain Layout

\series bold
SNP profiles. 
\series default

\begin_inset ERT
status collapsed

\begin_layout Plain Layout
{
\end_layout

\end_inset

SNP profiles for two of the best-ranked significant SNPs shown in the figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Table-Shared-SNPs"

\end_inset

.b. 
\series bold
a.
\series default
 SNP c2_45606 best-ranked by the four packages (central intersection of the Venn diagram Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Table-Shared-SNPs"

\end_inset

.b) 
\series bold
b.
\series default
 SNP c1_8019 best-ranked by the two tetraploid packages (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Table-Shared-SNPs"

\end_inset

.b), and also identified as significant by the same packages (at the bottom of the Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Table-Shared-SNPs"

\end_inset

.a). 
\begin_inset CommandInset label
LatexCommand label
name "fig:SNP-profiles"

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout
}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Chord diagrams for SNPs by chromosome
\end_layout

\begin_layout Standard
The chord diagrams visualize the location across the genome of the best-ranked associated SNPs shared among the four packages and described in the table 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Table-Shared-SNPs"

\end_inset

.a. Thus, in the case of the tetraploid potato, we found that they are located mostly in chromosome 10 (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Chord-diagrams"

\end_inset

.a). This visualization complements the manhattan plots from each GWAS package (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Chord-diagrams"

\end_inset

.b).
\end_layout

\begin_layout Standard

\begin_inset Float figure
wide false
sideways false
status open


\begin_layout Standard
\align center

\begin_inset Graphics 
	filename 08_figure-chord-manhattans.pdf
	width 11cm

\end_inset

 
\end_layout

\begin_layout Standard

\begin_inset Caption Standard

\begin_layout Plain Layout

\series bold
SNPs by chromosome.
\series default
 The position of best-ranked SNPs across chromosomes using two different visualizations. 
\series bold
a.
\series default
 Chord diagram showing that best-ranked SNPs located in chromosome 10. The SNPs are at the top and the chromosomes at the bottom. The arrows connect the best-ranked SNPs with their position in the chromosomes. 
\series bold
b.
\series default
 Manhattan plots from each GWAS packages showing two important locations of associations, chromosome 1 and chromosome 10, marked with blue and red ellipsis, respectively. 
\begin_inset CommandInset label
LatexCommand label
name "fig:Chord-diagrams"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Availability and Implementation
\end_layout

\begin_layout Standard
The core of the MultiGWAS tool runs under R and users can interact with the tool by either a command-line interface (CLI) developed in R or a graphical user interface (GUI) developed in Java (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:MultiGWAS-interaction"

\end_inset

). Source code, examples, documentation, and installation instructions are available at 
\begin_inset Flex Flex:URL
status collapsed

\begin_layout Plain Layout
https://github.com/agrosavia-bioinformatics/multiGWAS
\end_layout

\end_inset

.
\end_layout

\begin_layout Subsection
Input parameters
\end_layout

\begin_layout Standard
MutiGWAS uses as the only input a simple configuration text file with the values for the main parameters that drive the analysis. To create the configuration text file, users can choose either a text editor or the MultiGWAS GUI application. If users prefer a text file, it must have the parameter names and values separated by a colon, filenames enclosed in quotation marks, and TRUE or FALSE values to indicate if filters are applied. If the users prefer the GUI applications, they can create the configuration file using the input parameter view. In any case, this file must have the structure showed in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Configuration-file"

\end_inset

.
\end_layout

\begin_layout Standard

\begin_inset Float figure
placement H
wide false
sideways false
status open


\begin_layout Standard
\align center

\begin_inset Graphics 
	filename 09_figure-config-file.pdf

\end_inset

 
\end_layout

\begin_layout Standard

\begin_inset Caption Standard

\begin_layout Plain Layout
Configuration file for MultiGWAS. The input parameters include the organism's ploidy level (2: for diploids, 4: for tetraploids). The input genotype/phenotype filenames. The genome-wide significance threshold. The method for multiple testing correction. The GWAS model. The number of associations to report. The quality control filters choosing TRUE or FALSE. The filters are minor allele frequency, individual missing rate, SNP missing rate, and Hardy-Weinberg threshold. Finally, the GWAS packages selected for the analysis. 
\begin_inset CommandInset label
LatexCommand label
name "fig:Configuration-file"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Using the command line interface
\end_layout

\begin_layout Standard
The execution of the CLI tool is easy. It only needs to open a Linux console, change to the folder where is the configuration file, and type the executable tool's name, followed by the filename of the configuration file, like this:
\end_layout

\begin_layout Standard

\begin_inset listings
lstparams "language=bash,basicstyle={\small}"
inline false
status collapsed

\begin_layout Plain Layout
multiGWAS Test01.config
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Then, the tool starts the execution, showing information on the process in the console window. When it finishes, the results are in a new subfolder called 
\emph on

\begin_inset Quotes eld
\end_inset

out-Test01
\emph default
. The results include a complete HTML report containing the different views described in the results section, the source graphics and tables supporting the report, and the preprocessed tables from the results generated by the four GWAS packages used by MultiGWAS.
\end_layout

\begin_layout Standard

\begin_inset ERT
status collapsed

\begin_layout Plain Layout
% Preview source code from paragraph 134 to 137
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Using the graphical user interface
\end_layout

\begin_layout Standard
The interface allows users to save, load, or specify the different input parameters for MultiGWAS in a friendly way (Fig. 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:MultiGWAS-interaction"

\end_inset

). The input parameters correspond to the settings included in the configuration file described in subsection 
\begin_inset CommandInset ref
LatexCommand ref
reference "section-Reading-configuration-file"

\end_inset

. It executes by calling the following command from a Linux console:
\end_layout

\begin_layout Standard

\begin_inset listings
lstparams "language=bash,basicstyle={\small}"
inline false
status collapsed

\begin_layout Plain Layout
jmultiGWAS
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\begin_inset Float figure
placement H
wide false
sideways false
status open


\begin_layout Standard
\align center

\begin_inset Graphics 
	filename 10_figure-implementation-jmultiGWAS.png
	scale 50

\end_inset

 
\end_layout

\begin_layout Standard

\begin_inset Caption Standard

\begin_layout Plain Layout

\series bold
Main view of the MultiGWAS graphical user interface.
\series default
 The interface has a toolbar at the left side and four tabs at the top. In the toolbar, users can select the GWAS packages (Two for tetraploids and two for diploids). The analysis starts with the current parameters or loading a previously saved configuration. In the Input tab, users can set the parameters and quality control filters. The Output tab shows the execution of each process. In the results tab, users can browse the HTML report of the current analysis generated by the tool. Finally, in the Files tab, users can browse the source files of each software and access the produced data across the analysis.
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:MultiGWAS-interaction"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Section
Discussion
\end_layout

\begin_layout Standard
The reanalysis of potato data with MultiGWAS showed that this wrapping tool is handy to improve the GWAS in both diploid and tetraploid species. Through MultiGWAS performance, we could test its effectiveness to answer some of the challenges analyzing polyploid organisms. They include the integration and replication among parameters and software, the diploidization of polyploid data, and the incorporation of different inheritance mechanisms (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "dufresne2014"

\end_inset

).
\end_layout

\begin_layout Standard
The main advantage of MultiGWAS is that it replicates the GWAS analysis among four software and integrates the results obtained across software, models, and parameters. Therefore, in MultiGWAS, users do not have to choose between specificity or sensitivity because they can observe their effect in the analysis within the same wrapping environment.
\end_layout

\begin_layout Standard
Another difficulty for replication among software is the variability of structures for the genomic input data. Currently, the most common format for next-generation sequencing variant data is the VCF (Variant Call Format) (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Danecek2011"

\end_inset

; 
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Ebbert2014"

\end_inset

). One of the advantages of VCF is its versatility in summarizing important genome information for hundreds or thousands of individuals and SNP, including information about levels of ploidy. MultiGWAS simplifies the use of the GWAS software available because it allows the VCF files as an input (but see VarStats tool in VTC).
\end_layout

\begin_layout Standard
Moreover, the MultiGWAS is the unique wrapping tool we are aware of that facilitates understanding the effect of diploidizing the tetraploid data in the performance of the analysis directly. The SNP profile allows identifying what the significant associations detected by more than one software are. Furthermore, although MultiGWAS checks for significative SNPs based on the 
\emph on
p-value
\emph default
, it is essential to go back to the data and check if the SNP is a real association between the genotype and phenotype. For this purpose, the SNP profile gives visual feedback for the accuracy of the association.
\end_layout

\begin_layout Standard
Furthermore, the MultiGWAS allows comparing among the gene action models that offer GWASPoly and TASSEL. GWASpoly (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Rosyara2016"

\end_inset

) provides models of different types of polyploid gene action, including additive, diploidized additive, duplex dominant, simplex dominant, and general. On the other hand, TASSEL (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Bradbury2007"

\end_inset

) also models different types of gene action for general, additive, and dominant diploids. To choose among models, we propose an automatic selection of the gene action model for both tools based on a balance between three criteria: the inflation factor, the replicability of identified SNPs, and the significance of identified SNPs. This inflation index is a new tool for comparison that does not offer either GWASPoly or TASSEL. This automatic strategy will help to understand the gene action model for the trait of interest. Although the main focus is on the resultant SNPs, the model has assumptions that reflect the gene actions for a specific phenotype.
\end_layout

\begin_layout Standard
Finally, MultiGWAS, through the active comparison among models, addresses the search of the inheritance mechanisms by comparing among two designed for polysomic inheritance software (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Rosyara2016, Shen2016"

\end_inset

) with two software for disomic inheritance (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "Purcell2007, Bradbury2007"

\end_inset

). Understanding the inheritance mechanisms for polyploid organisms is an open question. For autopolyploids, most loci have a polysomic heritage. However, sections of the genome that did not duplicate lead to disomic inheritance for some loci (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "ohno1970, lynch2000,dufresne2014"

\end_inset

). Thus it is a useful tool for researchers because it looks for significative associations that involve both types of inheritance.
\end_layout

\begin_layout Subsection
Future remarks
\end_layout

\begin_layout Standard
The evolution and population genomics of polyploids is an exciting novel area of research. The advancement of next-gen sequencing techniques is producing more empirical polyploid data in different model and non-model organisms (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "ekblom2011applications,ellegren2014genome"

\end_inset

).
\end_layout

\begin_layout Standard
Many assumptions developed for diploids in the GWAS analysis do not apply entirely for polyploids (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "dufresne2014"

\end_inset

). Those include Hardy-Weinberg equilibrium, among others. Fortunately, in the last five years, different models to calculate several parameters for population genomics on polyploids are testing and developing in both simulated and empirical data (
\begin_inset CommandInset citation
LatexCommand cite
after ""
key "meirmans2018,hardy2016population,blischak2016accounting"

\end_inset

).
\end_layout

\begin_layout Standard
For MutiGWAS, we started with the most simple ploidy, such as tetraploids. Moreover, we did not filter data yet for HWE in tetraploids before GWAS as MultiGWAs do it for diploid data. Nevertheless, future MultiGWAS versions should include more complex ploidies further than tetraploids, as well as the explicit calculation of parameters either for filtering polyploid data before GWAS analysis or complementing other population genomics' parameters of the data analyzed.
\end_layout

\begin_layout Section
Acknowledgements
\end_layout

\begin_layout Standard
This research was possible thanks to AGROSAVIA five-years macroproject entitled 
\emph on
Investigación en conservación, caracterización y uso de los recursos genéticos vegetales
\emph default
.
\end_layout

\begin_layout Standard
We thanks to the Minister of Science, Technology and Innovation of the republic of Colombia (previously COLCIENCIAS), for supporting the postdoctoral researcher L. Garreta at AGROSAVIA during 2019-2020 under the supervision of ICS and PHRH (Grant number 811-2019). The editorial of AGROSAVIA gave for finatial supporting for this publication. Finally to Andres J. Cortés for his valuable comments to improve this manuscript.
\end_layout

\begin_layout Section
Author Contributions
\end_layout

\begin_layout Standard
LG, ICS, and PHRH conceived the idea. LG developed MultiGWAS. MP tested MultiGWAS. All authors wrote and approved the final version of the manuscript.
\end_layout

\begin_layout Standard

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

\backslash
printbibliography
\end_layout

\end_inset


\end_layout

\end_body
\end_document
